{   "Scenario": "test6",
	"Metadata": {},
        "start_delta": 20,
	"topology_filename": "./test6_topo.csv",
    	"networks": {
        "ab": {
            "network": "10.44.3.0/24",
            "gateway": "10.44.3.254"
        },
        "bc": {
            "network": "10.45.7.0/24",
            "gateway": "10.45.7.254"
        },
        "bd": {
            "network": "10.46.7.0/24",
            "gateway": "10.46.7.254"
        },
        "cd": {
            "network": "10.47.7.0/24",
            "gateway": "10.47.7.254"
        },
        "de": {
            "network": "10.48.7.0/24",
            "gateway": "10.48.7.254"
        }
    },
    "node_configs": {
        "__global": {
            "mounts": [["mounts/global", "/netem/mounts/global"]]
        },
        "node_a": {
	    "position": [0, 0],
            "container_image": "netem_ion",
            "ipv4_addresses": [["ab", "10.44.3.1"]],
            "mounts": [["mounts/node_a", "/netem/mounts/node_a"]],
            "working_dir": "/netem/mounts/node_a",
            "ion_config_INACTIVE": {"node_number": 1,
                    "config_dir": "/netem/mounts/node_a/ION_CONFIGS",
	    		    "outducts": [["node_b", "ltp"]]}
        },
        "node_b": {
            "container_image": "netem_ion",
            "ipv4_addresses": [["ab", "10.44.3.2"], ["bc", "10.45.7.1"], ["bd", "10.46.7.1"]],
            "mounts": [["mounts/node_b", "/netem/mounts/node_b"]],
            "working_dir": "/netem/mounts/node_b",
            "ion_config_INACTIVE": {"node_number": 2,
		           "outducts": [["node_a", "tcp"], ["node_c", "tcp"]],
                           "config_dir": "/netem/mounts/node_b/ION_CONFIGS"}
        },
        "node_c": {
	    "position": [2, 0],
            "container_image": "netem_ion",
            "ipv4_addresses": [["bc", "10.45.7.2"], ["cd", "10.47.7.1"]],
            "mounts": [["mounts/node_c", "/netem/mounts/node_c"]],
            "working_dir": "/netem/mounts/node_c",
            "ion_config_INACTIVE": {"node_number": 3,
		           "outducts": [["node_b", "tcp"], ["node_d", "tcp"]],
		           "config_dir": "/netem/mounts/node_c/ION_CONFIGS"}
        },
        "node_d": {
            "container_image": "netem_ion",
            "ipv4_addresses": [["bd", "10.46.7.2"], ["cd", "10.47.7.2"], ["de", "10.48.7.1"]],
            "mounts": [["mounts/node_d", "/netem/mounts/node_d"]],
            "working_dir": "/netem/mounts/node_d",
            "ion_config_INACTIVE": {"node_number": 4,
		           "outducts": [["node_b", "tcp"], ["node_d", "tcp"]],
		           "config_dir": "/netem/mounts/node_d/ION_CONFIGS"}
        },
        "node_e": {
            "container_image": "netem_ion",
            "ipv4_addresses": [["de", "10.48.7.2"]],
            "mounts": [["mounts/node_e", "/netem/mounts/node_e"]],
            "working_dir": "/netem/mounts/node_e",
            "ion_config_INACTIVE": {"node_number": 5,
		           "outducts": [["node_d", "tcp"]],
		           "config_dir": "/netem/mounts/node_e/ION_CONFIGS"}
        }
    },
    
    "commands": [
        {"time":-20, "nodes": ["node_a_INACTIVE"],  "command": "rm -rf /netem/mounts/global/ION_contacts ; mkdir -p /netem/mounts/global/ION_contacts"},
        {"time":-18, "nodes": ["STAR_INACTIVE"],  "command": "/netem/mounts/global/ION/main.py -w NETEM_NODE_NAME"},
        {"time":-17, "nodes": ["STAR_INACTIVE"],  "command": "cp /netem/mounts/NETEM_NODE_NAME/ION_CONFIGS/outbound_contacts.ionrc /netem/mounts/global/ION_contacts/NETEM_NODE_NAME_contacts.ionrc"},
        {"time":-12, "nodes": ["node_a_INACTIVE"],  "command": "cat /netem/mounts/global/ION_contacts/node_*.ionrc > /netem/mounts/global/ION_contacts/all_contacts.ionrc"},
        {"time":-11, "nodes": ["*"],  "command": "cd /netem/mounts/NETEM_NODE_NAME/ION_CONFIGS ; source ion.env ; /netem/mounts/global/start_ion.sh >& /netem/mounts/NETEM_NODE_NAME/start_ion.out ; sleep 1"},
        {"time": 0,  "nodes": ["*"],  "command": "cd /netem/mounts/global && ionadmin /netem/mounts/global/ION_contacts/all_contacts.ionrc && sleep 1"},
	    {"time": 10, "nodes": ["HOST"],   "command": "on_mon_rtt"},
	    {"time": 10, "nodes": ["HOST"],   "command": "on_bpstats"},
	    {"time": 10, "nodes": ["HOST"],   "command": "on_bplist"},
        {"time": 10, "nodes": ["node_a"], "command": "nohup bpecho ipn:1.1 >& /netem/mounts/node_a/bpecho.out &"},
        {"time": 10, "nodes": ["node_b"], "command": "nohup bpecho ipn:2.1 >& /netem/mounts/node_b/bpecho.out &"},
        {"time": 10, "nodes": ["node_c"], "command": "nohup bpecho ipn:3.1 >& /netem/mounts/node_c/bpecho.out &"},
        {"time": 10, "nodes": ["node_d"], "command": "nohup bpecho ipn:4.1 >& /netem/mounts/node_d/bpecho.out &"},
        {"time": 10, "nodes": ["node_e"], "command": "nohup bpecho ipn:5.1 >& /netem/mounts/node_e/bpecho.out &"},
        {"time": 20, "nodes": ["node_a"], "command": "nohup bping ipn:1.2 ipn:5.1 >& /netem/mounts/node_a/bping.out &"}
    ]
}
